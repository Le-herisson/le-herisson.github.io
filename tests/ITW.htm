<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
    <meta name="color-scheme" content="dark">
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="manifest" href="/manifest.json">
	<title>integration TW</title>
</head>
<body style="overflow:hidden;">
	<style>
		:root {background-color: #101010;}
		body {
			margin: 0;
		}
		iframe {
			display: block;
			background: #000;
			border: none;
			height: 100vh;
			width: 100vw;
		}
	</style>
	<h3 id="InfoText"></h3>
	<iframe id="iframeTwitch" src="about:blank" scrolling="no" allowfullscreen></iframe>
    <script>
		function ChannelError(){
			document.getElementById('InfoText').innerHTML = 'Error please see the console';
            document.getElementById('InfoText').style.fontFamily = "Consolas, monospace";
			console.error('The channel is not specified');
			console.warn('Use ?channel=:channel');
            document.getElementById('iframeTwitch').style.display = 'none';
			return "";
		}
		const hn = window.location.hostname;		
		const params = new URLSearchParams(window.location.search);
	
		const channel = params.get("channel") == null ? ChannelError() : params.get("channel");
		const autoplay = params.get("autoplay") == null ? false : params.get("autoplay");
		const muted = params.get("muted") == null ? true : params.get("muted");
	
		console.debug("channel = " + channel);
		console.debug("autoplay = " + autoplay);
		console.debug("muted = " + muted);
	
		const link = `https://player.twitch.tv/?channel=${channel}&parent=${hn}&autoplay=${autoplay}&muted=${muted}`;
		console.debug(link);
		document.getElementById('iframeTwitch').src = link;
		window.resizeTo(1300, 777);
	</script>
</body>
</html>
