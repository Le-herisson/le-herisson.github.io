<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
    <meta name="color-scheme" content="dark">
	<title>integration TW</title>
</head>
<body>
	<style>
        :root {
            background-color: #151515;
        }
    </style>
	<div class="twitch-embed-container" style="aspect-ratio:16/9;max-width:none;min-width:100%!important;">
		<h3 id="InfoText"></h3>
		<iframe id="iframeTwitch" src="about:blank" height="100%" width="100%" frameborder="0" allowfullscreen></iframe>
	</div>
        <script>
		function ChannelError(){
			document.getElementById('InfoText').innerHTML = 'Error please see the console';
            document.getElementById('InfoText').style.fontFamily = "Consolas, monospace";
			console.error('The channel is not specified');
			console.warn('Use ?channel=:channel');
            document.getElementById('iframeTwitch').style.display = 'none';
			return "";
		}
		const hn = window.location.hostname;		
		const params = new URLSearchParams(window.location.search);
	
		const channel = params.get("channel") == null ? ChannelError() : params.get("channel");
		const autoplay = params.get("autoplay") == null ? false : params.get("autoplay");
		const muted = params.get("muted") == null ? true : params.get("muted");
	
		console.debug("channel = " + channel);
		console.debug("autoplay = " + autoplay);
		console.debug("muted = " + muted);
	
		const link = `https://player.twitch.tv/?channel=${channel}&parent=${hn}&autoplay=${autoplay}&muted=${muted}`;
		console.debug(link);
		document.getElementById('iframeTwitch').src = link;
	</script>
</body>
</html>
