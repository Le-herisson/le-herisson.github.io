<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <title>Custom Youtube Player</title>
</head>
<body>
    <div>
        <h3 id="InfoText"></h3>
        <iframe id="iframeYt" src="about:blank" title="Video player" width="100%" style="border-radius: 0px; border: none; aspect-ratio: 16/9; min-height: 250px;" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture" allowfullscreen></iframe>
    </div>
    <script>
        function IdError(r) {
            document.getElementById('InfoText').innerHTML = 'Error please see the console';
            document.getElementById('InfoText').style.fontFamily = "Consolas, monospace";
            console.debug(r)
            console.error(r == 'missing' ? 'The id is not specified' : r == 'invalid' ? 'The id specified is invalid' : 'Error');
            console.warn('Use ?id=:vidId like : /[a-zA-Z0-9-_]{11}/g');
            document.getElementById('iframeYt').style.display = 'none';
            return "";
        }
        const params = new URLSearchParams(window.location.search);
        
        if (params.get('id') == null) {
            IdError('missing');
        } else {
            const id = params.get("id");
            const title = params.get("title") == null ? id : params.get("title");

            console.debug("id = " + id);
            console.debug(`title = ${title}`);

            if (id.slice(0, 11) != id) {
                IdError('invalidLenght')
            }

            let pattern = /[a-zA-Z0-9-_]{11}/;
            if (pattern.test(id)) {
                const link = `https://embed-player.com/video/?source=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D${id}&title=${title}&preload=none`;
                console.debug(`link = ${link}`);
                document.getElementById('iframeYt').src = link;
            } else {
                IdError('invalid');
            }
        }
    </script>
</body>
</html>