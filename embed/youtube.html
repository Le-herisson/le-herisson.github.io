<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Youtube Player</title>
</head>    
<body>
    <div>
        <h3 id="InfoText"></h3>
        <iframe id="iframeYt" src="about:blank" width="100%" style="border-radius: 0px; border: none; aspect-ratio: 16/9; min-height: 250px;" allowfullscreen></iframe>
    </div>
    <script>
        function IdError(r) {
            document.getElementById('InfoText').innerHTML = 'Error please see the console';
            document.getElementById('InfoText').style.fontFamily = "Consolas, monospace";
            console.debug(r)
            console.error(r == 'missing' ? 'The id is not specified' : r == 'invalid' ? 'The id specified is invalid' : 'Error');
            console.warn('Use ?vId=:vidId like : /[a-zA-Z0-9-_]{11}/g');
            document.getElementById('iframeYt').style.display = 'none';
        }
        const params = new URLSearchParams(window.location.search);
        if (params.has('dm') && params.get('dm') == "on") { document.body.style.backgroundColor = "#101010"; }
        if (params.has('vId')) {
            params.append('id', params.get('vId'));
            params.delete('vId');
        }
        if (params.get('id') == null) {
            IdError('missing');
        } else {
            const id = params.get("id");
            console.debug("id = " + id);

            if (id.slice(0, 11) != id) {
                IdError('invalidLenght')
            }

            let pattern = /[a-zA-Z0-9-_]{11}/;
            if (pattern.test(id)) {
                const link = `https://www.yout-ube.com/embed/${id}?autoplay=1&iv_load_policy=3&loop=1&start=0`;
                console.debug(link);
                document.getElementById('iframeYt').src = link;
            } else {
                IdError('invalid');
            }
        }
    </script>
</body>
</html>
